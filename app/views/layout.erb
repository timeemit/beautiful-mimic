<html>
<head>

  <title>beautiful mimic</title>
  <!-- Favicons -->
  <!-- Generated at http://www.favicon-generator.org -->
  <link rel='apple-touch-icon' sizes='57x57' href='../assets/images/favicons/apple-icon-57x57.png'>
  <link rel='apple-touch-icon' sizes='60x60' href='../assets/images/favicons/apple-icon-60x60.png'>
  <link rel='apple-touch-icon' sizes='72x72' href='../assets/images/favicons/apple-icon-72x72.png'>
  <link rel='apple-touch-icon' sizes='76x76' href='../assets/images/favicons/apple-icon-76x76.png'>
  <link rel='apple-touch-icon' sizes='114x114' href='../assets/images/favicons/apple-icon-114x114.png'>
  <link rel='apple-touch-icon' sizes='120x120' href='../assets/images/favicons/apple-icon-120x120.png'>
  <link rel='apple-touch-icon' sizes='144x144' href='../assets/images/favicons/apple-icon-144x144.png'>
  <link rel='apple-touch-icon' sizes='152x152' href='../assets/images/favicons/apple-icon-152x152.png'>
  <link rel='apple-touch-icon' sizes='180x180' href='../assets/images/favicons/apple-icon-180x180.png'>
  <link rel='icon' type='image/png' sizes='192x192' href='../assets/images/favicons/android-icon-192x192.png'>
  <link rel='icon' type='image/png' sizes='32x32' href='../assets/images/favicons/favicon-32x32.png'>
  <link rel='icon' type='image/png' sizes='96x96' href='../assets/images/favicons/favicon-96x96.png'>
  <link rel='icon' type='image/png' sizes='16x16' href='../assets/images/favicons/favicon-16x16.png'>
  <link rel='manifest' href='../assets/images/favicons/manifest.json'>
  <meta name='msapplication-TileColor' content='#ffffff'>
  <meta name='msapplication-TileImage' content='../assets/images/favicons/ms-icon-144x144.png'>
  <meta name='theme-color' content='#ffffff'>
  <!-- End Favicons -->

  <link rel='stylesheet' href='https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css'>
  <link rel='stylesheet' href='/stylesheets/pure.min.css'>
  <link rel='stylesheet' href='/stylesheets/grids-responseive.min.css'>
  <link rel='stylesheet' href='/style'>
  <script src='/javascripts/react-0.14.7.min.js'></script>
  <script src='/javascripts/react-dom-0.14.7.min.js'></script>
  <script src='/javascripts/babel-5.8.23.min.js'></script>
  <script src='/javascripts/jquery-2.2.0.min.js'></script>
</head>
<body>
  <!-- Header -->
  <div class='header center'>
    <div class='pure-g'>
      <div class='pure-u-1-8'>
        <img class='logo' src='/images/logo-yellow.png'>
      </div>
      <div class='pure-u-1-5'>
        <h1>
          <div class='pure-g'>
            <div class='pure-u-1 center-text logo-text'>beautiful</div>
            <div class='pure-u-1 center-text logo-text'>mimic</div>
          </div>
        </h1>
      </div>
    </div>
  </div>

  <!-- Content -->
  <div class='pure-g'>

    <div class='pure-u-1 pure-u-lg-1-3'>
      <div class='image-drawer hidden js-image-drawer'>
        <div class='center pointer-up'>
          <div class='green-background pointer-up-left'></div>
          <div class='green-background pointer-up-right'></div>
        </div>
        <div class='drawer green-background center'>
          <div class='pure-g'>
            <div class='pure-u-1-2'>
              <div class='center img-ctrl active'>
                <img class='pure-img center' src='../assets/images/marilyn-monroe.jpg'>
              </div>
            </div>
            <div class='pure-u-1-2'>
              <div class='center img-ctrl'>
                <img class='pure-img center grey-border' src='../assets/images/frank-sinatra.jpg'>
              </div>
            </div>
            <h3 class='pure-u-1 center-text'>
              <a href='http://app.beautifulmimic.com' class='pure-button pure-button-active'><i class='fa fa-upload'> Upload your own!</i></a>
            </h3>
          </div>
        </div>
      </div>
    </div>
    <div class='pure-u-1 pure-u-lg-1-3'>
    </div>
    <div class='pure-u-1 pure-u-lg-1-3'>
      <div class='image-drawer hidden js-image-drawer'>
        <div class='center pointer-up'>
          <div class='green-background pointer-up-left'></div>
          <div class='green-background pointer-up-right'></div>
        </div>
        <div class='drawer green-background center'>
          <div class='pure-g'>
            <div class='pure-u-1-2'>
              <div class='center img-ctrl active'>
                <img class='pure-img center' src='../assets/images/creation-of-adam.jpg'>
              </div>
            </div>
            <div class='pure-u-1-2'>
              <div class='center img-ctrl'>
                <img class='pure-img center' src='../assets/images/starry-night.jpg'>
              </div>
            </div>
            <div class='pure-u-1-2'>
              <div class='center img-ctrl'>
                <img class='pure-img center' src='../assets/images/bottle-of-anis.jpg'>
              </div>
            </div>
            <div class='pure-u-1-2'>
              <div class='center img-ctrl'>
                <img class='pure-img center' src='../assets/images/great-wave.jpg'>
              </div>
            </div>
            <div class='pure-u-1'>
              <h3 class='center-text'>
                <a href='http://app.beautifulmimic.com' class='pure-button pure-button-active'><i class='fa fa-upload'> Upload your own!</i></a>
              </h3>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id='content'></div>

  <script type='text/babel'>
    var ChosenImage = React.createClass({
      render: function(){
        return (<img onClick={this.props.click_handler} className='pure-img center grey-border hover-yellow-border' width='90%' src={'/uploads/' + this.props.file_hash + '/original'}></img>)
      }
    });

    var ImageDrawer = React.createClass({
      render: function(){
        var className = '';
        if ( !this.props.reveal ) {
          className += ' hidden';
        }
        return (
          <div className={'image-drawer js-image-drawer' + className}>
            <div className='center pointer-up'>
              <div className='green-background pointer-up-left'></div>
              <div className='green-background pointer-up-right'></div>
            </div>
            <div className='drawer green-background center'>
              <UploadedImages choice_handler={this.props.choice_handler} chosen={this.props.chosen} uploads={this.props.uploads} />
              <Uploader />
            </div>
          </div>
        );
      }

    });

    var UploadedImages = React.createClass({
      render: function(){
        var chosen = this.props.chosen;
        var choice_handler = this.props.choice_handler;
        var imgs = this.props.uploads.map(function(upload) {
          return ( <UploadedImage choice_handler={choice_handler} upload={upload} chosen={chosen} /> )
        });
        return (
          <div className='pure-g'>
          { imgs }
          </div>
        );
      }
    });

    var UploadedImage = React.createClass({
      choose_image: function() {
        this.props.choice_handler(this.props.upload);
      },
      render: function(){
        var className = 'center img-ctrl';
        if ( this.props.chosen.file_hash === this.props.upload.file_hash ) {
          className += ' active';
        }
        return (
          <div className='pure-u-1-2'>
            <div className={ className } >
              <img width='80%' onClick={ this.choose_image } className='pure-img center grey-border' src={ '/uploads/' + this.props.upload.file_hash }></img>
            </div>
          </div>
        );
      }
    });

    var Uploader = React.createClass({
      render: function(){
        return (
          <div className='pure-g'>
            <h3 className='pure-u-1 center-text'>
              <a href='http://app.beautifulmimic.com' className='pure-button pure-button-active'>
                <i class='fa fa-upload'> Upload your own!</i>
              </a>
            </h3>
          </div>
        )
      }
    });

    var NewMimic = React.createClass({
      getInitialState: function() {
        return {
          uploads: [],
          content_choice: {},
          style_choice: {},
          reveal_content: false,
          reveal_style: false
        };
      },

      componentDidMount: function() {
        this.serverRequest = $.get('/uploads', function (result) {
          var result = JSON.parse(result);
          this.setState({
            uploads: result,
            content_choice: result[0],
            style_choice: result[1],
            reveal_content: false,
            reveal_style: false
          });
        }.bind(this));
      },

      componentWillUnmount: function() {
        this.serverRequest.abort();
      },

      choose_content: function(choice) {
        this.setState({ content_choice: choice });
      },

      choose_style: function(choice) {
        this.setState({ style_choice: choice });
      },

      toggle_content: function() {
        this.setState({
          reveal_content: !this.state.reveal_content,
          reveal_style: false
        });
      },

      toggle_style: function() {
        this.setState({
          reveal_content: false,
          reveal_style: !this.state.reveal_style
        });
      },

      render: function() {
        return (
          <div className='pure-g'>
            <div className='pure-u-1 pure-u-lg-1-3'>
              <h1 className='center-text'>Photo</h1>
              <ChosenImage click_handler={this.toggle_content} file_hash={this.state.content_choice.file_hash} />
              <ImageDrawer choice_handler={this.choose_content} reveal={this.state.reveal_content} uploads={this.state.uploads} chosen={this.state.content_choice} />
            </div>
            <div className='pure-u-1 pure-u-lg-1-3'>
              <h1 className='center-text'>+</h1>
            </div>
            <div className='pure-u-1 pure-u-lg-1-3'>
              <h1 className='center-text'>Style</h1>
              <ChosenImage click_handler={this.toggle_style} file_hash={this.state.style_choice.file_hash} />
              <ImageDrawer choice_handler={this.choose_style} reveal={this.state.reveal_style} uploads={this.state.uploads} chosen={this.state.style_choice} />
            </div>
          </div>
        );
      },
    });

    ReactDOM.render(
      <NewMimic />, document.getElementById('content')
    );

  </script>
</body>
</html>
